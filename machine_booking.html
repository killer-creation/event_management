<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>VIP Traders - Event Machine Rentals</title>
<link rel="stylesheet" href="machine_booking.css">
</head>
<body>
<a href="javascript:history.back()" class="back-button">
    &#8592; Back
</a>
<nav>
  <h1>VIP Traders</h1>
  <ul>
    <li><a href="user dashboard.html">Home</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>
</nav>

<main>
  <section class="machine-category">
    <h2>Cold Pyro Fan</h2>
    <div class="machine-container">
      <div class="machine-item cold-pyro" data-name="Cold Pyro Single Fan" data-price="2000">
        <img src="images/cold piro single fan.png" alt="Cold Pyro Single Fan">
        <h3>Cold Pyro Single Fan</h3>
        <p class="price">₹2,000</p>
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item cold-pyro" data-name="Cold Pyro Fan Display" data-price="2500">
        <img src="images/cold piro single fan1.png" alt="Cold Pyro Fan Display">
        <h3>Cold Pyro Fan Display</h3>
      </div>
    </div>
  </section>

  <section class="machine-category">
    <h2>Bubble Machines</h2>
    <div class="machine-container">
      <div class="machine-item bubble" data-name="Standard Bubble Machine" data-price="1800">
        <img src="images/bubble machine.png" alt="Bubble Machine">
        <h3>Standard Bubble Machine</h3>
        <p class="price">₹1,800</p>
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item bubble" data-name="Bubble Display" data-price="2200">
        <img src="images/bubble machine1.png" alt="Bubble Display">
        <h3>Bubble Display</h3>
              </div>
    </div>
  </section>

  <section class="machine-category">
    <h2>LED Liquid Jet Machine</h2>
    <div class="machine-container">
      <div class="machine-item led" data-name="LED Liquid Jet Machine" data-price="3000">
        <img src="images/led liquide jet machine.png" alt="LED Liquid Jet Machine">
        <h3>LED Liquid Jet Machine</h3>
        <p class="price">₹3,000</p>
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item led" data-name="LED Liquid Jet Display" data-price="3500">
        <img src="images/led liquide jet machine1.png" alt="LED Liquid Jet Display">
        <h3>LED Liquid Jet Display</h3>
              </div>
    </div>
  </section>

  <section class="machine-category">
    <h2>Flame Machines</h2>
    <div class="machine-container">
      <div class="machine-item flame" data-name="Flame Machine" data-price="4000">
        <img src="images/flame machine.png" alt="Flame Machine">
        <h3>Flame Machine</h3>
        <p class="price">₹4,000</p>
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item flame" data-name="Multiple Flame Machine Display" data-price="4500">
        <img src="images/flame machine1.png" alt="Multiple Flame Machines">
        <h3>Multiple Flame Machine Display</h3>
              </div>
    </div>
  </section>

  <section class="machine-category">
    <h2>Paper Blasters</h2>
    <div class="machine-container">
      <div class="machine-item paper" data-name="Jambo Paper Blaster" data-price="2500">
        <img src="images/jambo paper blaster.png" alt="Jambo Paper Blaster">
        <h3>Jambo Paper Blaster</h3>
        <p class="price">₹2,500</p>
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item paper" data-name="Paper Blaster Display" data-price="2800">
        <img src="images/paper blaster.png" alt="Paper Blaster Display">
        <h3>Paper Blaster Display</h3>
             </div>
    </div>
  </section>

  <section class="machine-category">
    <h2>SFX Fog Machine</h2>
    <div class="machine-container">
      <div class="machine-item fog" data-name="SFX Fog Machine" data-price="3000">
        <img src="images/sfx fog machine.png" alt="SFX Fog Machine">
        <h3>SFX Fog Machine</h3>
        <p class="price">₹3,000</p>
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item fog" data-name="SFX Fog Machine Display" data-price="3300">
        <img src="images/sfx fog machine1.png" alt="SFX Fog Machine Display">
        <h3>SFX Fog Machine Display</h3>
              </div>
    </div>
  </section>

  <section class="machine-category">
    <h2>Mini Foam Machine</h2>
    <div class="machine-container">
      <div class="machine-item foam" data-name="Mini Foam Machine" data-price="2800">
        <img src="images/mini foam machine.png" alt="Mini Foam Machine">
        <h3>Mini Foam Machine</h3>
        <p class="price">₹2,800
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item foam" data-name="Mini Foam Machine Display" data-price="3200">
        <img src="images/mini foam machine1.png" alt="Mini Foam Machine Display">
        <h3>Mini Foam Machine Display</h3>
        </div>
    </div>
  </section>
<section class="machine-category">
    <h2>Pyro gun</h2>
    <div class="machine-container">
      <div class="machine-item foam" data-name="Pyro gun" data-price="2800">
        <img src="images/pyrogun.png" alt="Mini Foam Machine">
        <h3>pyrogun</h3>
        <p class="price">₹2,800
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item foam" data-name="pyrogun Display" data-price="3200">
        <img src="images/pyrogun1.png" alt="Mini Foam Machine Display">
        <h3>pyrogun Display</h3>
        </div>
    </div>
  </section>


  <section class="machine-category">
    <h2>Pyro V2 Sparkler Machine</h2>
    <div class="machine-container">
      <div class="machine-item sparkler" data-name="Pyro V2 Sparkler Machine" data-price="5000">
        <img src="images/pyro v2 sparklar machine.png" alt="Pyro V2 Sparkler Machine">
        <h3>Pyro V2 Sparkler Machine</h3>
        <p class="price">₹5,000</p>
        <a href="#" class="book-now">Book Now</a>
      </div>
      <div class="machine-item sparkler" data-name="Pyro V2 Sparkler Display" data-price="5500">
        <img src="images/py1.png" alt="Pyro V2 Sparkler Display">
        <h3>Pyro V2 Sparkler Display</h3>
      </div>
    </div>
  </section>
</main>
<div id="bookingModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Book Your Machine</h2>
    <form id="bookingForm" action="PaymentServlet1" method="post">
      <input type="text" id="machineName" name="machine_name" placeholder="Machine Name" readonly required>
      <input type="number" id="quantity" name="quantity" placeholder="Quantity" min="1" required>
      <input type="number" id="totalAmount" name="total_amount" placeholder="Total Amount" readonly required>
      <input type="datetime-local" id="datetime" name="date_time" required>
      <input type="tel" id="mobile" name="mobile_number" placeholder="Mobile No" pattern="[0-9]{10}" required>
      <input type="text" id="address" name="address" placeholder="Address" required>
      <button type="submit">Confirm Booking</button>
    </form>
  </div>
</div>
<div id="paymentModal" class="modal" style="display: none;">
  <div class="modal-content">
    <span class="close-payment-modal">×</span>
    <h2>Payment Details</h2>
    <form id="paymentForm" action="PaymentServlet1" method="post">
      <input type="hidden" id="machineNameHidden" name="machine_name">
      <input type="hidden" id="quantityHidden" name="quantity">
      <input type="hidden" id="totalAmountHidden" name="total_amount">
      <input type="hidden" id="datetimeHidden" name="date_time">
      <input type="hidden" id="mobileNumberHidden" name="mobile_no">
      <input type="hidden" id="addressHidden" name="address">
      
      <div style="text-align:center; padding: 20px;">
        <h3>Total Payable: <span id="paymentTotal"></span></h3>
        <br>
        <label for="payment_method">Payment Method:</label>
        <select id="payment_method" name="payment_method" required>
          <option value="Online Payment">Online Payment</option>
          <option value="Cash on Delivery">Cash on Delivery</option>
        </select>
      </div> 
      <button type="submit" class="pay-btn">Pay Now</button>
    </form>
  </div>
</div>
<footer id="contact">
  <p>&copy; 2025 VIP Traders. All Rights Reserved.</p>
  <p>Contact: info@viptraders.com | +91 9876543210</p>
</footer>

<script>
  // Get all 'Book Now' buttons
  const bookNowButtons = document.querySelectorAll('.book-now');

  // Get modal elements
  const bookingModal = document.getElementById('bookingModal');
  const closeModal = document.querySelector('.close');

  // Get form elements
  const machineNameInput = document.getElementById('machineName');
  const quantityInput = document.getElementById('quantity');
  const totalAmountInput = document.getElementById('totalAmount');
  let currentPrice = 0;

  // Add a click event listener to each 'Book Now' button
  bookNowButtons.forEach(button => {
    button.addEventListener('click', (event) => {
      // Prevent the default link behavior
      event.preventDefault();

      // Get the parent machine item
      const machineItem = button.closest('.machine-item');

      // Get the data from the data attributes
      const machineName = machineItem.getAttribute('data-name');
      const machinePrice = machineItem.getAttribute('data-price');

      // Update the global price variable and set form values
      currentPrice = parseInt(machinePrice);
      machineNameInput.value = machineName;
      quantityInput.value = 1; // Reset quantity to 1
      totalAmountInput.value = currentPrice;

      // Display the modal
      bookingModal.style.display = 'block';
    });
  });

  // Event listener to close the modal when the 'X' is clicked
  closeModal.addEventListener('click', () => {
    bookingModal.style.display = 'none';
  });

  // Event listener to close the modal when clicking outside of it
  window.addEventListener('click', (event) => {
    if (event.target === bookingModal) {
      bookingModal.style.display = 'none';
    }
  });

  // Auto calculate total
  quantityInput.addEventListener("input", () => {
    let qty = parseInt(quantityInput.value) || 1;
    totalAmountInput.value = currentPrice * qty;
  });

  // This is the crucial part that was causing the error
  document.getElementById('bookingForm').addEventListener('submit', function(e) {
	  e.preventDefault(); 

	  // Get data from the first form
	  const machineName = document.getElementById('machineName').value;
	  const quantity = document.getElementById('quantity').value;
	  const totalAmount = document.getElementById('totalAmount').value;
	  const datetime = document.getElementById('datetime').value;
	  const mobile = document.getElementById('mobile').value;
	  const address = document.getElementById('address').value;

	  // Pass data to the HIDDEN fields in the SECOND (payment) form
      // Make sure the IDs match the new IDs, and the 'name' attributes match the servlet's expected parameters
	  document.getElementById('machineNameHidden').value = machineName;
	  document.getElementById('quantityHidden').value = quantity;
	  document.getElementById('totalAmountHidden').value = totalAmount;
	  document.getElementById('datetimeHidden').value = datetime;
	  document.getElementById('mobileNumberHidden').value = mobile;
	  document.getElementById('addressHidden').value = address;
	  
	  // Set the total amount in the payment form display
	  document.getElementById('paymentTotal').textContent = `₹${totalAmount}`;

	  // Show the payment modal
	  document.getElementById('paymentModal').style.display = 'block';

	  // Hide the initial booking modal
	  document.getElementById('bookingModal').style.display = 'none';
  });

  // Close the payment modal
  document.querySelector('.close-payment-modal').onclick = () => {
	  document.getElementById('paymentModal').style.display = 'none';
  };
</script>
</body>
</html>